<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار ربط Firebase</title>
</head>
<body>

    <h1>صفحة اختبار ربط Firebase</h1>
    <p>هذه الصفحة ستحاول الاتصال بـ Firebase وجلب رسالة من مجلد "test".</p>

    <hr>
    
    <h2>النتيجة:</h2>
    <h1 id="result" style="color: blue; font-size: 2em; border: 2px solid blue; padding: 10px;">
        جاري الاتصال...
    </h1>

    <!-- ====================================================== -->
    <!-- برمجة "المحرك" (Firebase) - نسخة الاختبار -->
    <!-- ====================================================== -->
    <script type="module">
        // --- الخطوة 1: استيراد المكتبات الضرورية ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // --- الخطوة 2: تهيئة Firebase (نفس المفتاح) ---
        const firebaseConfig = {
          apiKey: "AIzaSyBSiZVCImHeuTGg37LCqWaGmn-s0CDGoQM",
          authDomain: "nourelectro-store.firebaseapp.com",
          projectId: "nourelectro-store",
          storageBucket: "nourelectro-store.firebasestorage.app",
          messagingSenderId: "943638742849",
          appId: "1:943638742849:web:a42dda2e2049a5da0903c0",
          measurementId: "G-GQQE3691ED"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- الخطوة 3: برمجة جلب "رسالة الاختبار" ---
        
        const resultElement = document.getElementById('result');

        async function fetchTestMessage() {
            try {
                // 1. اذهب إلى "مجلد" test
                const querySnapshot = await getDocs(collection(db, "test"));

                if (querySnapshot.empty) {
                    resultElement.textContent = 'فشل: تم الاتصال، ولكن مجلد "test" فارغ.';
                    resultElement.style.color = 'orange';
                }

                // 2. قم بالمرور على كل "رسالة"
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    // 3. اعرض الرسالة
                    resultElement.textContent = data.message; // <-- سيعرض "Hello from Firebase"
                    resultElement.style.color = 'green';
                });

            } catch (error) {
                resultElement.textContent = `فشل ذريع: حدث خطأ. ${error.message}`;
                resultElement.style.color = 'red';
            }
        }

        // ابدأ الاختبار
        fetchTestMessage();
    </script>

</body>
</html>

